<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>binary_analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<div id="Notes on Binary Analysis in Linux"><h1 id="Notes on Binary Analysis in Linux" class="header"><a href="#Notes on Binary Analysis in Linux">Notes on Binary Analysis in Linux</a></h1></div>

<p>
This page is created while reading the book
</p>
<ul>
<li>
<span id="Notes on Binary Analysis in Linux-Learning Linux Binary Analysis"></span><strong id="Learning Linux Binary Analysis">Learning Linux Binary Analysis</strong> by <span id="Notes on Binary Analysis in Linux-Ryan &quot;Elfmaster&quot; O'Neill"></span><strong id="Ryan &quot;Elfmaster&quot; O'Neill">Ryan "Elfmaster" O'Neill</strong>

</ul>

<p>
Hearty Thanks and Kudos to Ryan for writing this book
</p>

<p>
<span class="todo">TODO</span>: TOC
</p>

<div id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis"><h2 id="gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis" class="header"><a href="#Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis">gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis</a></h2></div>
<ul>
<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-gas"></span><strong id="gas">gas</strong> - GNU linker and assembler

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-gdb"></span><strong id="gdb">gdb</strong> - GNU Debugger

</ul>

<div id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format"><h3 id="Executable and Linkable Format" class="header"><a href="#Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format">Executable and Linkable Format</a></h3></div>
<ul>
<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-objdump"></span><strong id="objdump">objdump</strong> - displays information from object files

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-objcopy"></span><strong id="objcopy">objcopy</strong> - object copy and translate object files

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-strace"></span><strong id="strace">strace</strong> - trace system calls and signals

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-ltrace"></span><strong id="ltrace">ltrace</strong> - library call tracer

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-ptrace"></span><strong id="ptrace">ptrace</strong> - a system call to trace a process

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-ftrace"></span><strong id="ftrace">ftrace</strong> - trace the call to the fucntions within the binary

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-nm"></span><strong id="nm">nm</strong> - list symbols from object files

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-addr2line"></span><strong id="addr2line">addr2line</strong> - Convert addresses to file name and line numbers

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-c++filt"></span><strong id="c++filt">c++filt</strong> - Filter to demangle encoded c++ symbols

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-strip"></span><strong id="strip">strip</strong> - discrads symbols from the binary

<li>
<span id="Notes on Binary Analysis in Linux-gnu_tools_for_binary|Tools for the Trade : GNU Tools for Binary Analysis-Executable and Linkable Format-string"></span><strong id="string">string</strong> - prints listable strings from a file

</ul>

<div id="Notes on Binary Analysis in Linux-Relocatable code injection"><h2 id="Relocatable code injection" class="header"><a href="#Notes on Binary Analysis in Linux-Relocatable code injection">Relocatable code injection</a></h2></div>
<ul>
<li>
Eresi (<a href="http://www.eresi-project.org)">http://www.eresi-project.org)</a>

<li>
Quenya. <a href="http://www.bitlackeys.org/projects/quenya_32bit.tgz">http://www.bitlackeys.org/projects/quenya_32bit.tgz</a>

</ul>

<div id="Notes on Binary Analysis in Linux-shape_of_linux_binary|The ELF Binary Format"><h2 id="shape_of_linux_binary|The ELF Binary Format" class="header"><a href="#Notes on Binary Analysis in Linux-shape_of_linux_binary|The ELF Binary Format">shape_of_linux_binary|The ELF Binary Format</a></h2></div>
<ul>
<li>
complicated and dry \<em>0</em>/

<li>
compostion of

<ul>
<li>
program loading

<li>
dynamic linking

<li>
symbol table lookups

</ul>
<li>
program execution implies ELF binary format

</ul>

<div id="Notes on Binary Analysis in Linux-ELF Layout"><h2 id="ELF Layout" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout">ELF Layout</a></h2></div>

<table>
<tr>
<th>
ELF Header
</th>
</tr>
<tr>
<th>
Section Header Table
</th>
</tr>
<tr>
<th>
Program Header Table
</th>
</tr>
<tr>
<th>
Dynamic Section
</th>
</tr>
<tr>
<th>
Relocation Section
</th>
</tr>
<tr>
<th>
&nbsp;
</th>
</tr>
</table>


<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types"><h3 id="ELF file types" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types">ELF file types</a></h3></div>
<p>
ELF file types
</p>
<ul>
<li>
ET_NONE - unknown type

<li>
ET_REL - Relocatable object files are generally pieces of Position independent
           code - (PIC) that have not yet been linked into an executable.
           compiled object code

<li>
ET_EXEC - executable, entry point for a process

<li>
ET_DYN - shared object

<li>
ET_CORE - core file, dump of a full process image during the time of a progra
            crash or when process has delivered a SIGSEGV. use GDB to read core

</ul>

<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Program headers"><h4 id="Program headers" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Program headers">Program headers</a></h4></div>
<pre>
psg@psglinux:~/working/work-env$ readelf -h /bin/ls
ELF Header:
Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
Class:                             ELF64
Data:                              2's complement, little endian
Version:                           1 (current)
OS/ABI:                            UNIX - System V
ABI Version:                       0
Type:                              DYN (Shared object file)
Machine:                           Advanced Micro Devices X86-64
Version:                           0x1
Entry point address:               0x5850
Start of program headers:          64 (bytes into file)
Start of section headers:          132000 (bytes into file)
Flags:                             0x0
Size of this header:               64 (bytes)
Size of program headers:           56 (bytes)
Number of program headers:         9
Size of section headers:           64 (bytes)
Number of section headers:         28
Section header string table index: 27
</pre>

<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Program Header"><h4 id="Program Header" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Program Header">Program Header</a></h4></div>
<ul>
<li>
An executable or shared object file's program header table is an array of
  structures, each describing a segment or other information the system needs to
  prepare the program for exe‚Äêcution. An object file segment contains one or
  more sections.  Program headers are  meaningful  only  for  executable  and
  shared object files.

<li>
Describes the memory layout of a program

<li>
The  main difference between the 32-bit and the 64-bit program header lies in
  the location of the p_flags member in the total struct.

</ul>

<pre>
psg@psglinux:~/working/work-env$ readelf -l /bin/ls

Elf file type is DYN (Shared object file)
Entry point 0x5850
There are 9 program headers, starting at offset 64

Program Headers:
  Type           Offset             VirtAddr           PhysAddr
                 FileSiz            MemSiz              Flags  Align
  PHDR           0x0000000000000040 0x0000000000000040 0x0000000000000040
                 0x00000000000001f8 0x00000000000001f8  R E    0x8
  INTERP         0x0000000000000238 0x0000000000000238 0x0000000000000238
                 0x000000000000001c 0x000000000000001c  R      0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000
                 0x000000000001e6e8 0x000000000001e6e8  R E    0x200000
  LOAD           0x000000000001eff0 0x000000000021eff0 0x000000000021eff0
                 0x0000000000001278 0x0000000000002570  RW     0x200000
  DYNAMIC        0x000000000001fa38 0x000000000021fa38 0x000000000021fa38
                 0x0000000000000200 0x0000000000000200  RW     0x8
  NOTE           0x0000000000000254 0x0000000000000254 0x0000000000000254
                 0x0000000000000044 0x0000000000000044  R      0x4
  GNU_EH_FRAME   0x000000000001b1a0 0x000000000001b1a0 0x000000000001b1a0
                 0x0000000000000884 0x0000000000000884  R      0x4
  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000
                 0x0000000000000000 0x0000000000000000  RW     0x10
  GNU_RELRO      0x000000000001eff0 0x000000000021eff0 0x000000000021eff0
                 0x0000000000001010 0x0000000000001010  R      0x1

 Section to Segment mapping:
  Segment Sections...
   00
   01     .interp
   02     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame
   03     .init_array .fini_array .data.rel.ro .dynamic .got .data .bss
   04     .dynamic
   05     .note.ABI-tag .note.gnu.build-id
   06     .eh_frame_hdr
   07
   08     .init_array .fini_array .data.rel.ro .dynamic .got
</pre>
<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Section Header"><h4 id="Section Header" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Section Header">Section Header</a></h4></div>
<p>
The text segments will be as follows:
‚Ä¢ [.text]: This is the program code
‚Ä¢ [.rodata]: This is read-only data
‚Ä¢ [.hash]: This is the symbol hash table
‚Ä¢ [.dynsym ]: This is the shared object symbol data
‚Ä¢ [.dynstr ]: This is the shared object symbol name
‚Ä¢ [.plt]: This is the procedure linkage table
‚Ä¢ [.rel.got]: This is the G.O.T relocation data
The data segments will be as follows:
‚Ä¢ [.data]: These are the globally initialized variables
‚Ä¢ [.dynamic]: These are the dynamic linking structures and objects
‚Ä¢ [.got.plt]: This is the global offset table
‚Ä¢ [.bss]: These are the globally uninitialized variables
</p>

<ul>
<li>
ELF symbols

<ul>
<li>
there exist two symbol tables.

<li>
-S output shown previously, you can see two sections:

<ul>
<li>
.dynsym : global symbols that reference symbols from an external source, such as libc functions like printf,

<li>
.symtab : will contain all of the symbols in .dynsym, as well as the local symbols for the executable, such as global variables, or local functions that you have defined in your code

</ul>
</ul>
</ul>

<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Symbols"><h4 id="Symbols" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Symbols">Symbols</a></h4></div>
<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Relocations"><h4 id="Relocations" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Relocations">Relocations</a></h4></div>
<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Dynamic Linking"><h4 id="Dynamic Linking" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Dynamic Linking">Dynamic Linking</a></h4></div>
<div id="Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Coding an ELF Parser"><h4 id="Coding an ELF Parser" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-ELF file types-Coding an ELF Parser">Coding an ELF Parser</a></h4></div>



<p>
= compilation ===
</p>
<div id="Notes on Binary Analysis in Linux-ELF Layout-linking"><h3 id="linking" class="header"><a href="#Notes on Binary Analysis in Linux-ELF Layout-linking">linking</a></h3></div>
<div id="Notes on Binary Analysis in Linux-Debugging a binary as a black box"><h2 id="Debugging a binary as a black box" class="header"><a href="#Notes on Binary Analysis in Linux-Debugging a binary as a black box">Debugging a binary as a black box</a></h2></div>
<div id="Notes on Binary Analysis in Linux-Debugging a binary as a black box-understanding the sys and proc files"><h3 id="understanding the sys and proc files" class="header"><a href="#Notes on Binary Analysis in Linux-Debugging a binary as a black box-understanding the sys and proc files">understanding the sys and proc files</a></h3></div>
<div id="Notes on Binary Analysis in Linux-Debugging a binary as a black box-process files : files to looks for in /proc"><h3 id="process files : files to looks for in /proc" class="header"><a href="#Notes on Binary Analysis in Linux-Debugging a binary as a black box-process files : files to looks for in /proc">process files : files to looks for in /proc</a></h3></div>
<div id="Notes on Binary Analysis in Linux-Debugging a binary as a black box-process files : files to looks for in /sys"><h3 id="process files : files to looks for in /sys" class="header"><a href="#Notes on Binary Analysis in Linux-Debugging a binary as a black box-process files : files to looks for in /sys">process files : files to looks for in /sys</a></h3></div>

</body>
</html>
